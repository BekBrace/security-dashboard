<!DOCTYPE html> <!-- Declares the document type and version of HTML (HTML5) -->
<html lang="en"> <!-- Starts the HTML document and sets the language to English -->
<head> <!-- Metadata and resources go here -->
    <meta charset="UTF-8"> <!-- Sets character encoding to UTF-8 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Makes page responsive on all devices -->
    <title>Security Testing Dashboard</title> <!-- Sets the title shown in the browser tab -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"> <!-- Adds TailwindCSS for styling -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> <!-- Loads Axios library for HTTP requests -->
</head>
<body class="bg-gray-100"> <!-- Body starts with a light gray background -->

    <div class="container mx-auto px-4 py-8"> <!-- Wrapper with center alignment and padding -->
        <h1 class="text-4xl font-bold text-center mb-8 text-blue-600">Security Testing Dashboard</h1> <!-- Main title -->

        <!-- SSL Certificate Checker -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6"> <!-- White box with shadow and spacing -->
            <h2 class="text-2xl font-semibold mb-4">SSL Certificate Checker</h2> <!-- Section title -->
            <div class="flex gap-4"> <!-- Flexbox layout with space between children -->
                <input type="text" id="sslDomain" placeholder="Enter domain (e.g., example.com)" 
                       class="flex-1 p-2 border rounded"> <!-- Text input for domain -->
                <button onclick="checkSSL()" 
                        class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Check SSL
                </button> <!-- Button triggers SSL check -->
            </div>
            <div id="sslResult" class="mt-4"></div> <!-- Container for displaying SSL result -->
        </div>

        <!-- DNS Record Analyzer -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6"> <!-- Another section styled like above -->
            <h2 class="text-2xl font-semibold mb-4">DNS Record Analyzer</h2>
            <div class="flex gap-4">
                <input type="text" id="dnsDomain" placeholder="Enter domain (e.g., example.com)" 
                       class="flex-1 p-2 border rounded">
                <button onclick="checkDNS()" 
                        class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                    Analyze DNS
                </button>
            </div>
            <div id="dnsResult" class="mt-4"></div>
        </div>

        <!-- HTTP Headers Security Check -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-semibold mb-4">HTTP Headers Security Check</h2>
            <div class="flex gap-4">
                <input type="text" id="headerUrl" placeholder="Enter URL (e.g., https://example.com)" 
                       class="flex-1 p-2 border rounded">
                <button onclick="checkHeaders()" 
                        class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600">
                    Check Headers
                </button>
            </div>
            <div id="headersResult" class="mt-4"></div>
        </div>
    </div>

    <script> // Begin JavaScript script block

    // üîí Function to check SSL certificate
    async function checkSSL() { // Define an async function to check SSL certificate details
        const domain = document.getElementById('sslDomain').value; // Get domain name from input field
        const resultDiv = document.getElementById('sslResult'); // Reference the div where SSL results will be displayed
        try {
            const response = await axios.post('/api/check-ssl', { domain }); // Send POST request with domain to backend SSL-check API
            resultDiv.innerHTML = ` <!-- Display SSL details in a styled result box -->
                <div class="bg-gray-100 p-4 rounded">
                    <p><strong>Valid:</strong> ${response.data.valid}</p> <!-- Show whether SSL is valid -->
                    <p><strong>Days Remaining:</strong> ${response.data.daysRemaining}</p> <!-- Show remaining days until expiry -->
                    <p><strong>Valid From:</strong> ${response.data.validFrom}</p> <!-- Show certificate start date -->
                    <p><strong>Valid To:</strong> ${response.data.validTo}</p> <!-- Show certificate expiry date -->
                </div>
            `;
        } catch (error) {
            resultDiv.innerHTML = `<div class="text-red-500">Error: ${error.response?.data?.error || error.message}</div>`; // Show error if request fails
        }
    }

    // üåê Function to check DNS records
    async function checkDNS() { // Define an async function to check DNS records
        const domain = document.getElementById('dnsDomain').value; // Get domain name from input field
        const resultDiv = document.getElementById('dnsResult'); // Reference the div where DNS results will be displayed
        try {
            const response = await axios.post('/api/check-dns', { domain }); // Send POST request with domain to backend DNS-check API
            resultDiv.innerHTML = `
                <div class="bg-gray-100 p-4 rounded">
                    <pre class="whitespace-pre-wrap">${JSON.stringify(response.data, null, 2)}</pre> <!-- Display DNS response as pretty-printed JSON -->
                </div>
            `;
        } catch (error) {
            resultDiv.innerHTML = `<div class="text-red-500">Error: ${error.response?.data?.error || error.message}</div>`; // Show error if request fails
        }
    }

    // üì¶ Function to check HTTP headers
    async function checkHeaders() { // Define an async function to check HTTP headers
        const url = document.getElementById('headerUrl').value; // Get URL input value from text field
        const resultDiv = document.getElementById('headersResult'); // Reference the div where header results will be displayed
        try {
            const response = await axios.post('/api/check-headers', { url }); // Send POST request with URL to backend headers-check API
            let html = '<div class="bg-gray-100 p-4 rounded">'; // Start building result HTML container
            for (const [header, value] of Object.entries(response.data)) { // Loop through each header and value from API response
                html += `<p><strong>${header}:</strong> ${value || 'Not set'}</p>`; // Append each header and value (or "Not set" if empty)
            }
            html += '</div>'; // Close the HTML result container
            resultDiv.innerHTML = html; // Insert constructed header results into the result div
        } catch (error) {
            resultDiv.innerHTML = `<div class="text-red-500">Error: ${error.response?.data?.error || error.message}</div>`; // Show error if request fails
        }
    }

</script> // End JavaScript script block

</body>
</html>
